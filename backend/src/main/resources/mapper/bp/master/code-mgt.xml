<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
    공통코드 관리 Mapper
    테이블: PCM_COM_GRP_CD (그룹코드), PCM_COM_DTL_CD (상세코드)
-->
<mapper namespace="smartcost.app.bp.master.CodeMgtRepository">

    <!-- ============================================================
         그룹코드 목록 조회
         ============================================================ -->
    <select id="findListGrpCd" parameterType="map" resultType="map">
        SELECT  GRP_CD   AS "grpCd"
              , GRP_NM   AS "grpNm"
              , USE_YN   AS "useYn"
              , SORT_NO  AS "sortNo"
              , RMK      AS "rmk"
          FROM  PCM_COM_GRP_CD
         WHERE  TEN_ID = #{g.tenant}
         ORDER BY SORT_NO, GRP_CD
    </select>

    <!-- ============================================================
         그룹코드 신규 등록
         ============================================================ -->
    <insert id="insertGrpCd" parameterType="map">
        INSERT INTO PCM_COM_GRP_CD (TEN_ID, GRP_CD, GRP_NM, USE_YN, SORT_NO, RMK, REGR_ID, REG_DTTM, MODR_ID, MOD_DTTM)
        VALUES (#{g.tenant}, #{p.grpCd}, #{p.grpNm}, #{p.useYn}, #{p.sortNo}, #{p.rmk}, #{g.username}, #{g.now}, #{g.username}, #{g.now})
    </insert>

    <!-- ============================================================
         그룹코드 수정
         ============================================================ -->
    <update id="updateGrpCd" parameterType="map">
        UPDATE PCM_COM_GRP_CD
           SET GRP_NM  = #{p.grpNm}
             , USE_YN  = #{p.useYn}
             , SORT_NO = #{p.sortNo}
             , RMK     = #{p.rmk}
             , MODR_ID = #{g.username}
             , MOD_DTTM = #{g.now}
         WHERE TEN_ID = #{g.tenant}
           AND GRP_CD = #{p.grpCd}
    </update>

    <!-- ============================================================
         상세코드 목록 조회
         ============================================================ -->
    <select id="findListDtlCd" parameterType="map" resultType="map">
        SELECT  DTL_CD   AS "dtlCd"
              , CD_NM    AS "cdNm"
              , SORT_NO  AS "sortNo"
              , USE_YN   AS "useYn"
              , ATTR1    AS "attr1"
              , ATTR2    AS "attr2"
              , ATTR3    AS "attr3"
              , ATTR4    AS "attr4"
              , RMK      AS "rmk"
              , GRP_CD   AS "grpCd"
          FROM  PCM_COM_DTL_CD
         WHERE  TEN_ID = #{g.tenant}
           AND  GRP_CD = #{p.grpCd}
         ORDER BY SORT_NO, DTL_CD
    </select>

    <!-- ============================================================
         상세코드 신규 등록
         ============================================================ -->
    <insert id="insertDtlCd" parameterType="map">
        INSERT INTO PCM_COM_DTL_CD (TEN_ID, GRP_CD, DTL_CD, CD_NM, SORT_NO, USE_YN, ATTR1, ATTR2, ATTR3, ATTR4, RMK, REGR_ID, REG_DTTM, MODR_ID, MOD_DTTM)
        VALUES (#{g.tenant}, #{p.grpCd}, #{p.dtlCd}, #{p.cdNm}, #{p.sortNo}, #{p.useYn}, #{p.attr1}, #{p.attr2}, #{p.attr3}, #{p.attr4}, #{p.rmk}, #{g.username}, #{g.now}, #{g.username}, #{g.now})
    </insert>

    <!-- ============================================================
         상세코드 수정
         ============================================================ -->
    <update id="updateDtlCd" parameterType="map">
        UPDATE PCM_COM_DTL_CD
           SET CD_NM   = #{p.cdNm}
             , SORT_NO = #{p.sortNo}
             , USE_YN  = #{p.useYn}
             , ATTR1   = #{p.attr1}
             , ATTR2   = #{p.attr2}
             , ATTR3   = #{p.attr3}
             , ATTR4   = #{p.attr4}
             , RMK     = #{p.rmk}
             , MODR_ID = #{g.username}
             , MOD_DTTM = #{g.now}
         WHERE TEN_ID = #{g.tenant}
           AND GRP_CD = #{p.grpCd}
           AND DTL_CD = #{p.dtlCd}
    </update>

    <!-- ============================================================
         상세코드 삭제
         ============================================================ -->
    <delete id="deleteDtlCd" parameterType="map">
        DELETE FROM PCM_COM_DTL_CD
         WHERE TEN_ID = #{g.tenant}
           AND GRP_CD = #{p.grpCd}
           AND DTL_CD = #{p.dtlCd}
    </delete>

</mapper>
